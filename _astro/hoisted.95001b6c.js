const B="_bird_8jnhm_1",L={bird:B,"flap-wings":"_flap-wings_8jnhm_1"},O={src:"/zengarden/_astro/bird-1.06b966f3.png",width:800,height:800,format:"png"},A={src:"/zengarden/_astro/bird-2.bfce9e81.png",width:486,height:486,format:"png"},q={src:"/zengarden/_astro/bird-3.3f0e9084.png",width:800,height:800,format:"png"},N={src:"/zengarden/_astro/bird-4.0985a33e.png",width:317,height:297,format:"png"},D={src:"/zengarden/_astro/bird-5.e7e73b41.png",width:138,height:160,format:"png"},F={src:"/zengarden/_astro/bird-6.4f54cb68.png",width:233,height:316,format:"png"},H={src:"/zengarden/_astro/bird-7.0c55f116.png",width:201,height:205,format:"png"},R={src:"/zengarden/_astro/bird-8.3541f78e.png",width:171,height:273,format:"png"},T={src:"/zengarden/_astro/bird-9.892f8dd6.png",width:486,height:486,format:"png"},V={src:"/zengarden/_astro/bird-10.f30e737d.png",width:800,height:800,format:"png"},W={src:"/zengarden/_astro/bird-11.6756f69a.png",width:178,height:308,format:"png"},X=[O,A,q,N,D,F,H,R,T,V,W];function k(e,t){return Math.floor(e-e%t)}function _(e,t,a,i){const c=e-a,g=t-i;return Math.sqrt(c*c+g*g)}function d(){return Math.min(1,Math.max(-1,Math.random()*2-1))}function M(e,t=90){return Math.min(255,Math.max(0,Math.round(e+(Math.random()*t-t/2))))}function v(e){const t=Math.floor(Math.random()*e.length);return e[t]}const z=20,E=16;class Y{constructor(t,a,i){this.x=t,this.y=a;const c=v(X);this.element=document.createElement("div"),this.element.classList.add(L.bird);const g=document.createElement("img");g.src=c.src,g.width=c.width/E,g.height=c.height/E,this.element.appendChild(g),i.appendChild(this.element)}element;angle=d()*Math.PI;speed=d();start(){const t=()=>{if(this.speed=Math.min(Math.max(this.speed+d()/10,0),4),this.angle+=this.speed>1?d()*.3:0,this.x+=this.speed*Math.cos(this.angle),this.y+=this.speed*Math.sin(this.angle),this.x<-z||this.x>window.innerWidth+z||this.y<-z||this.y>window.innerHeight+z){this.element.remove();return}this.element.style.transform=`translate3d(${this.x}px, ${this.y}px, 0) rotate(${this.angle}rad)`,requestAnimationFrame(t)};t()}}const j=e=>new Y(e.x,e.y,e.el).start(),r={windPerFrame:20,spread:20,flower:{id:"flower",partSize:()=>12,stroke:1,gap:0,palette:[{r:255,g:0,b:0},{r:255,g:51,b:51},{r:255,g:102,b:102},{r:255,g:153,b:153},{r:255,g:204,b:204},{r:0,g:102,b:204}],colorNoise:90,edge:2,noisyOpacity:30},grass:{id:"grass",partSize:()=>120,stroke:8,gap:0,palette:[{r:0,g:255,b:0},{r:51,g:255,b:51},{r:102,g:255,b:102},{r:153,g:255,b:153},{r:204,g:255,b:204}],colorNoise:90,edge:2,noisyOpacity:30},tree:{id:"tree",partSize:()=>d()*20+50,stroke:8,gap:60,palette:[{r:0,g:128,b:0},{r:0,g:102,b:0},{r:0,g:76,b:0},{r:0,g:51,b:0},{r:0,g:25,b:0}],colorNoise:90,edge:6,noisyOpacity:0},water:{id:"water",partSize:()=>120,stroke:12,gap:0,palette:[{r:0,g:51,b:102},{r:0,g:85,b:170},{r:0,g:68,b:136},{r:0,g:102,b:204},{r:0,g:119,b:179}],colorNoise:80,edge:1,noisyOpacity:0},ground:{id:"ground",partSize:()=>220,stroke:8,gap:0,palette:[{r:153,g:102,b:51},{r:204,g:153,b:102},{r:128,g:128,b:128},{r:194,g:178,b:128},{r:102,g:102,b:102}],colorNoise:30,edge:4,noisyOpacity:60}};function G(e){u(e.flowers),u(e.grass),u(e.trees),u(e.water),u(e.ground);const t={grass:e.grass.getContext("2d"),flowers:e.flowers.getContext("2d"),trees:e.trees.getContext("2d"),water:e.water.getContext("2d"),ground:e.ground.getContext("2d")};C(e.ambience);const a=()=>{y(),requestAnimationFrame(a)};a();let i=!1,c=0,g=0;document.body.addEventListener("pointerdown",b),document.body.addEventListener("pointermove",l),document.body.addEventListener("pointerup",m),document.body.addEventListener("pointercancel",m);function b(o){i=!0,l(o)}function l(o){i&&f(o.clientX,o.clientY)}function m(){i=!1}function f(o,n){if(e.controls.layer==="birds")return j({x:o,y:n,el:e.ambience});if(o*=2,n*=2,e.controls.layer==="water"){const s=o+d()*r.spread,h=n+d()*r.spread;p(t.water,s,h,r.water),p(t.ground,s,h,r.ground),S(t.flowers,s,h,r.water.partSize()/2+20),S(t.trees,s,h,r.water.partSize()/2+20);return}if(e.controls.layer==="flowers")p(t.flowers,o+d()*r.spread,n+d()*r.spread,r.flower),p(t.flowers,o+d()*r.spread,n+d()*r.spread,r.flower);else if(e.controls.layer==="trees"&&_(o,n,c,g)>r.tree.gap){const s=o+d()*r.spread,h=n+d()*r.spread;p(t.trees,s,h,r.tree),c=o,g=n}p(t.grass,o+d()*r.spread,n+d()*r.spread,r.grass)}function y(){for(let o=0;o<r.windPerFrame;o++){const n=Math.floor(Math.random()*window.innerWidth)*2,s=Math.floor(Math.random()*window.innerHeight)*2;w(t.water,n-2*r.water.stroke,s-2*r.water.stroke)&&w(t.water,n+r.water.stroke,s+r.water.stroke)?p(t.water,n,s,{...r.water,partSize:()=>3*r.water.stroke}):w(t.trees,n-2*r.tree.stroke,s-2*r.tree.stroke)&&w(t.trees,n+r.tree.stroke,s+r.tree.stroke)?p(t.trees,n,s,{...r.tree,partSize:()=>3*r.tree.stroke}):w(t.grass,n-2*r.grass.stroke,s-2*r.grass.stroke)&&w(t.grass,n+r.grass.stroke,s+r.grass.stroke)&&p(t.grass,n,s,{...r.grass,partSize:()=>3*r.grass.stroke})}}}function p(e,t,a,i){const{palette:c,noisyOpacity:g,edge:b,stroke:l,colorNoise:m}=i,f=i.partSize(),y=k(t-f/2,l),o=k(a-f/2,l),n=v(c);for(let s=y;s<y+f;s+=l)for(let h=o;h<o+f;h+=l){const P=_(s,h,t,a),x=M(255*(1-Math.pow(P/(.6*f),b)),g)/255,$=`rgba(${M(n.r,m)}, ${M(n.g,m)}, ${M(n.b,m)}, ${x})`;e.fillStyle=$,e.fillRect(s,h,l-.1,l-.1)}}function w(e,t,a){return e.getImageData(t,a,1,1).data[3]>180}function S(e,t,a,i){e.save(),e.beginPath(),e.arc(t,a,i,0,2*Math.PI),e.closePath(),e.clip(),e.clearRect(t-i,a-i,2*i,2*i),e.restore()}function u(e){e.getContext("2d").scale(2,2),e.width=window.innerWidth*2,e.height=window.innerHeight*2}function C(e){var t=5e3,a=(Math.sin(Date.now()/t)+1)/2;J(a,e),requestAnimationFrame(()=>C(e))}function J(e,t){const a=e*2*Math.PI,i=Math.pow(Math.cos(a/4),4);var c=0,g=Math.floor(-30*i),b=Math.floor(100-50*i),l=`sepia(${c}%) hue-rotate(${g}deg) brightness(${b}%)`;t.style.filter=l}const I={layer:"flowers"};document.querySelector("#controls")?.addEventListener("pointerdown",e=>e.stopPropagation(),{capture:!0});document.querySelectorAll('input[name="layer"]').forEach(e=>{e.addEventListener("change",t=>{I.layer=t.currentTarget.value})});G({paintArea:document.getElementById("game"),ambience:document.getElementById("ambience"),grass:document.getElementById("grass"),flowers:document.getElementById("flowers"),trees:document.getElementById("trees"),water:document.getElementById("water"),ground:document.getElementById("ground"),controls:I});
